{% extends "base.html" %}
{% load static %}

{% block title %} DameVino - Vinoteca {% endblock %}

{% block content %}

<div class="container-fluid px-5 py-5" >
    <div id="colD" class="row px-5 py-5" style="background-color: #a1ded6;">
        <div class="col-xs-12 col-sm-3 px-0" style="overflow-y: auto; max-height: 500px;">
            <form id="f" method="GET">
                <div class="accordion" id="acordeon">
                    <div class="card border-secondary">
                        <div class="card-header" id="headVino">
                            <h2 class="mb-0">
                                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseVino" aria-expanded="true" aria-controls="collapseVino">
                                    <span style="float: left;">Tipo de vino</span>
                                    <span style="float: rigth; margin-left: 100px;">
                                        <svg class="bi bi-chevron-down" width="0.7em" height="0.7em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"/>
                                        </svg>
                                    </span>
                                </button>
                            </h2>
                        </div>
                        <div id="collapseVino" class="collapse" aria-labelledby="headVino" data-parent="#acordeon">
                            <div class="card-body" style="padding-left: 3.5em;">
                                <label><input type="checkbox" id="vinoTinto" name="vinos[]" value="Vino tinto"> Vino tinto</label><br>
                                <label><input type="checkbox" id="vinoBlanco" name="vinos[]" value="Vino blanco"> Vino blanco</label><br>
                                <label><input type="checkbox" id="vinoRosado" name="vinos[]" value="Vino rosado"> Vino rosado</label><br>
                                <label><input type="checkbox" id="vinoEspumoso" name="vinos[]" value="Vino espumoso"> Vino espumoso</label><br>
                                <label><input type="checkbox" id="vinoGeneroso" name="vinos[]" value="Vino generoso"> Vino generoso</label><br>
                                <label><input type="checkbox" id="vinoDulce" name="vinos[]" value="Vino dulce"> Vino dulce</label><br>
                            </div>
                        </div>
                    </div>
                    <div class="card border-secondary">
                        <div class="card-header" id="headDenom">
                            <h2>
                                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseDenom" aria-expanded="true" aria-controls="collapseDenom">
                                    <span style="float: left;">Denominación</span>
                                    <span style="float: rigth; margin-left: 78px;">
                                        <svg class="bi bi-chevron-down" width="0.7em" height="0.7em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"/>
                                        </svg>
                                    </span>
                                </button>
                            </h2>
                        </div>
                        <div id="collapseDenom" class="collapse" aria-labelledby="headDenom" data-parent="#acordeon">
                            <div class="card-body" style="padding-left: 3.5em;">

                            </div>
                        </div>
                    </div>
                    <div class="card border-secondary">
                        <div class="card-header" id="headMarid">
                            <h2>
                                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseMarid" aria-expanded="true" aria-controls="collapseMarid">
                                    <span style="float: left;">Maridaje</span>
                                    <span style="float: rigth; margin-left: 135px;">
                                        <svg class="bi bi-chevron-down" width="0.7em" height="0.7em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"/>
                                        </svg>
                                    </span>
                                </button>
                            </h2>
                        </div>
                        <div id="collapseMarid" class="collapse" aria-labelledby="headMarid" data-parent="#acordeon">
                            <div class="card-body" style="padding-left: 3.5em;">
                                
                            </div>
                        </div>
                    </div>
                    <div class="card border-secondary">
                        <div class="card-header" id="headP">
                            <h2>
                                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseP" aria-expanded="true" aria-controls="collapseP">
                                    <span style="float: left;">Puntuación</span>
                                    <span style="float: rigth; margin-left: 110px;">
                                        <svg class="bi bi-chevron-down" width="0.7em" height="0.7em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 01.708 0L8 10.293l5.646-5.647a.5.5 0 01.708.708l-6 6a.5.5 0 01-.708 0l-6-6a.5.5 0 010-.708z" clip-rule="evenodd"/>
                                        </svg>
                                    </span>
                                </button>
                            </h2>
                        </div>
                        <div id="collapseP" class="collapse show" aria-labelledby="headP" data-parent="#acordeon">
                            <div class="card-body">
                                <div class="slidecontainer">
                                    <input type="range" min="1" max="100" value="50" class="slider" id="myRange">
                                    <p>Puntos: <span id="demo"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="list-group py-3">
                    <button type="submit" class="btn botonFiltro">Aplicar filtros</button>
                </div>
            </form>    
        </div>
        <div class="col-xs-12 col-sm-9 d-flex justify-content-end" id="grupoVinos">
            <div id="cartas" style="overflow-y: auto; max-height: 500px; width: 95%;">
                {% if vinos %}
                    {% for vino in vinos %}
                        <div class="card border-secondary mb-1">
                            <div class="row no-gutters">
                                <div class="col-xs-10 col-md-4">
                                    <img src={{vino.img}} width="150" height="215" style="margin: 1em;" class="card-img" alt="...">
                                </div>
                                <div class="col-md-8">
                                    <div class="card-body">
                                        <h5 class="card-title" style="font-size: 2em;">{{vino.nombre}}</h5>
                                        <p class="card-text" style="font-size: 1.2em;"><small class="text-muted">Tipo: {{vino.tipo}}</small></p>
                                        <p class="card-text" style="font-size: 1.2em;"><small class="text-muted">D.O: {{vino.denominacion}}</small></p>
                                        <br/>
                                        <a href="{% url 'detalles' vino.id %}" class="btn boton">Ver detalles</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block js %}

<script>

    $(document).ready(function()
    {
        var slider = document.getElementById("myRange");
        var output = document.getElementById("demo");
        output.innerHTML = slider.value;

        slider.oninput = function()
        {
            output.innerHTML = this.value;
        }
    });

    $(function() {
        'use strict';
    
        $('#f').on('submit', function() {
            
            var fD = "";

            $("#f input[type=checkbox]").each(function(){
                if(this.checked)
                    fD += $(this).val()+", ";
            })

            $.get("{% url 'filtroVinoteca' %}", {"fD": fD}, function(data){
                var html = "";
                var n = data.length;
                var vId;
                $("#cartas").empty();
                for(var i = 0; i<n; i++){
                    var vId = data[i].id;
                    html+='<div class="card border-secondary mb-1">'
                            +'<div class="row no-gutters">'
                                    +'<div class="col-xs-10 col-md-4">'
                                        +'<img src='+ data[i].img +' width="150" height="215" style="margin: 1em;" class="card-img" alt="...">'
                                    +'</div>'
                                    +'<div class="col-md-8">'    
                                        +'<div class="card-body">'
                                            +'<h5 class="card-title">'+ data[i].nombre +'</h5>'
                                            +'<p class="card-text" style="font-size: 1.2em;"><small class="text-muted">Tipo: '+ data[i].tipo +'</small></p>'
                                            +'<p class="card-text" style="font-size: 1.2em;"><small class="text-muted">D.O: '+ data[i].denominacion +'</small></p>'
                                            +'</br>'
                                            +'<a href="../detalles/'+vId+'" class="btn boton">Ver Detalles</a>'
                                        +'</div>'
                                    +'</div>'
                                +'</div>'
                            +'</div>'
                        +'</div>';
                }
                $("#cartas").append(html);
            })
            return false;
        });
    });
</script>

{% endblock %}